{% extends 'base.html' %}
{% load static %}
{% load i18n %}

{% block title %}{% trans "Ajouter Une classe" %}{% endblock %}

{% block main %}
<div class="containaire">
  <h2>
    {% if Title %}{{ Title }}{% else %}{% trans "Ajouter Une classe" %}{% endif %}
  </h2>

  {% if form.errors %}
    <div class="error-messages bg-danger">
      <ul>
        {% for field, errors in form.errors.items %}
          {% for error in errors %}
            <li>{{ error }}</li>
          {% endfor %}
        {% endfor %}
      </ul>
    </div>
  {% endif %}

  <form method="post" id="classeForm">
    {% csrf_token %}

    <div class="row g-3">

      <div class="col-md-6">
        <label class="form-label">{% trans "Niveau" %} <span class="text-danger">*</span></label>
        {{ form.niveau }}
      </div>

      <div class="col-md-6">
        <label class="form-label">{% trans "Classe avec spécialité ?" %} <span class="text-danger">*</span></label>
        {{ form.a_specialite }}
      </div>

      <div class="col-md-6">
        <label class="form-label">{% trans "Nom de la classe" %} <span class="text-danger">*</span></label>
        {{ form.nom }}
      </div>

      <div class="col-md-6">
        <label class="form-label">{% trans "Status" %} <span class="text-danger">*</span></label>
        {{ form.actif }}
      </div>

      <!-- Spécialité (cachée par défaut) -->
      <div class="col-md-6" id="specialite-field">
        <label class="form-label">{% trans "Spécialité" %} <span class="text-danger">*</span></label>
        {{ form.specialite }}
      </div>

      <div class="col-md-12 d-flex justify-content-end gap-2 mt-3">
        <a class="btn btn-success" href="{% url 'ListeDesClasse' %}">{% trans "Retour" %}</a>
        <button type="submit" class="btn btn-dark">{% trans "Enregistre" %}</button>
      </div>

    </div>
  </form>
</div>

<script>
document.addEventListener('DOMContentLoaded', function () {
  const toggleSpecialite = document.getElementById('id_a_specialite');
  const specialiteField = document.getElementById('specialite-field');

  function updateSpecialite() {
    if (toggleSpecialite && toggleSpecialite.checked) {
      specialiteField.style.display = 'block';
    } else {
      specialiteField.style.display = 'none';
      const sp = document.getElementById('id_specialite');
      if (sp) sp.value = '';
    }
  }

  updateSpecialite();
  if (toggleSpecialite) toggleSpecialite.addEventListener('change', updateSpecialite);
});
</script>
{% endblock %}
