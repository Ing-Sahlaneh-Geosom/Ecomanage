{% extends 'base.html' %}
{% load static i18n %}
{% get_current_language as LANGUAGE_CODE %}

{% block title %}{% trans "Ajouter un eleve" %}{% endblock %}
{% block main %}

<div class="containaire bg-light" {% if LANGUAGE_CODE == 'ar' %}dir="rtl"{% endif %}>
    <h2>{{ Title }}</h2>

    {% if form.errors %}
  <div class="error-messages bg-danger">
    <ul>
      {% for field in form %}
        {% for error in field.errors %}
          <li><strong>{{ field.label }}:</strong> {{ error }}</li>
        {% endfor %}
      {% endfor %}
      {% for error in form.non_field_errors %}
        <li>{{ error }}</li>
      {% endfor %}
    </ul>
  </div>
{% endif %}


    <form method="POST" enctype="multipart/form-data" class="form">
        {% csrf_token %}

        <div>
            <label for="nom">{% trans "Nom Complete" %} :</label>
            {{ form.nom }}
        </div>

        <div>
            <label for="sexe">{% trans "Sexe" %} :</label>
            {{ form.Sexe }}
        </div>

        <div>
            <label for="date_naissancce">{% trans "Date de naissance" %} :</label>
            {{ form.date_naissancce }}
            <small style="display:block;">
                {% trans "Format" %}: {% trans "jj/mm/aaaa" %}
            </small>
        </div>

        <div>
            <label for="adrress">{% trans "Adrress" %}</label>
            {{ form.adrress }}
        </div>

        <div>
            <label for="telephone">{% trans "Telephone" %} :</label>
            {{ form.telephone }}
        </div>

        <div>
            <label for="email">{% trans "Email" %} :</label>
            {{ form.email }}
        </div>

        <div>
            <label for="photo">{% trans "Image" %} :</label>
            {{ form.photo }}

            <div id="fileHint" style="margin-top:6px;color: black;">
                {% trans "Aucun fichier choisi" %}
            </div>

            {% if form.instance.photo %}
                <div style="margin-top:10px;">
                <small style="display:block;color:#333;">
                    {% trans "Image actuelle" %}: {{ form.instance.photo.name }}
                </small>
                <img src="{{ form.instance.photo.url }}" alt="photo" style="height:70px;width:70px;object-fit:cover;border-radius:8px;border:1px solid #ddd;">
                </div>
            {% endif %}
        </div>


        <div>
            <label for="classe">{% trans "Classe" %} :</label>
            <select name="classe" id="classe">
                <option value="">{% trans "Select" %}</option>
                {% for classe in classes %}
                <option value="{{ classe.id }}" {% if form.instance.classe_id == classe.id %}selected{% endif %}>
                {{ classe.nom }}
                </option>

                {% endfor %}
            </select>
        </div>

        <div>
            <label for="parent">{% trans "Nom du mere" %} :</label>
            {{ form.parent }}
        </div>

        <div>
            <label for="telephone_parent">{% trans "Telephone Parent" %}</label>
            {{ form.telephone_parent }}
        </div>

        <div>
            <label for="email_parent">{% trans "Email parent" %}</label>
            {{ form.email_parent }}
        </div>

        <div>
            <label for="status">{% trans "Status" %}</label>
            {{ form.status }}
        </div>

        <div class="full-width">
            <button type="submit" class="submit-btn">{{ Submit_text }}</button>
        </div>

    </form>

</div>

<script>
(function () {
  const input = document.querySelector('input[type="file"][name="photo"], input[type="file"]');
  const hint = document.getElementById("fileHint");
  if (!input || !hint) return;

  const emptyText = hint.textContent;

  input.addEventListener("change", function () {
    if (this.files && this.files.length > 0) {
      hint.textContent = this.files[0].name;
    } else {
      hint.textContent = emptyText;
    }
  });
})();
</script>

{% endblock %}
